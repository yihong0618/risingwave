(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{84808:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/heap_profiling",function(){return t(16318)}])},49636:function(e,n,t){"use strict";t.d(n,{OL:function(){return i},X8:function(){return o},dL:function(){return c},xv:function(){return a}});var l=t(97400),r=t(35862);async function o(){return await r.ZP.get("/metrics/cluster")}async function a(){return(await r.ZP.get("/clusters/1")).map(l.cX.fromJSON)}async function i(){return(await r.ZP.get("/clusters/2")).map(l.cX.fromJSON)}async function c(){return await r.ZP.get("/version")}},44599:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var l=t(67294),r=t(61642);function o(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],[o,a]=(0,l.useState)(),i=(0,r.Z)();return(0,l.useEffect)(()=>{let l=async()=>{if(t)try{let n=await e();a(n)}catch(e){i(e)}};if(l(),!n)return;let r=setInterval(l,n);return()=>clearInterval(r)},[i,n,t]),{response:o}}},16318:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return C}});var l=t(85893),r=t(40639),o=t(83234),a=t(57026),i=t(47741),c=t(63764),s=t(45772),u=t.n(s),d=t(42474),f=t(9008),h=t.n(f),p=t(1864),g=t.n(p),m=t(67294),x=t(79613),j=t(64030),v=t(35862),w=t(49636),y=t(44599),P=t(68905);function C(){let{response:e}=(0,y.Z)(w.OL),[n,t]=(0,m.useState)(),[s,f]=(0,m.useState)(""),[p,C]=(0,m.useState)(),[_,E]=(0,m.useState)(),[N,b]=(0,m.useState)("Auto"),[S,Z]=(0,m.useState)();async function X(e,n){if(e&&n&&e.length>0)try{let e=P.R_.fromJSON(await v.ZP.get("/monitor/list_heap_profile/".concat(n)));C(e)}catch(e){console.error(e),f("Getting Profiling File List\n\nError: ".concat(e.message,"\n").concat(e.cause))}}async function k(){try{await v.ZP.get("/monitor/dump_heap_profile/".concat(n)),X(e,n)}catch(e){f("Dumping heap profile.\n\nError: ".concat(e.message,"\n").concat(e.cause))}}async function z(){let e;if(void 0===_||void 0===S){console.log("selectedProfileList: ".concat(_,", analyzeTargetFileName: ").concat(S));return}let t=g().join(_.dir,S);f("Analyzing ".concat(S," from Compute Node ").concat(n));let l="Collapsed Profiling of Compute Node ".concat(n," for ").concat(S);try{let r=u()(t),o=await fetch("/monitor/analyze/".concat(n,"/").concat(r)).then(async e=>({filename:e.headers.get("content-disposition"),blob:await e.blob()})),a=window.URL.createObjectURL(o.blob),i=document.createElement("a");i.href=a,i.download=o.filename||(0,d.randomUUID)(),i.click(),e="".concat(l,"\n\nDownloaded!")}catch(n){e="".concat(l,"\n\nError: ").concat(n.message)}f(e)}(0,m.useEffect)(()=>{e&&!n&&e.length>0&&t(e[0].id)},[e,n]),(0,m.useEffect)(()=>{X(e,n)},[e,n]),(0,m.useEffect)(()=>{p&&("Auto"===N?E({dir:p.dir,name:p.nameAuto}):"Manually"===N?E({dir:p.dir,name:p.nameManually}):console.error("Bad profileType ".concat(N)))},[N,p]),(0,m.useEffect)(()=>{_&&_.name.length>0&&Z(_.name[0])},[_]);let D=(0,l.jsxs)(r.kC,{p:3,height:"calc(50vh - 20px)",flexDirection:"column",children:[(0,l.jsx)(j.Z,{children:"Heap Profiling"}),(0,l.jsxs)(r.kC,{flexDirection:"row",height:"full",width:"full",children:[(0,l.jsxs)(r.gC,{mr:3,spacing:3,alignItems:"flex-start",width:200,height:"full",children:[(0,l.jsxs)(o.NI,{children:[(0,l.jsx)(o.lX,{textColor:"blue.500",children:"Dump Heap Profile"}),(0,l.jsxs)(r.gC,{children:[(0,l.jsx)(o.lX,{children:"Compute Nodes"}),(0,l.jsx)(a.Ph,{onChange:e=>t(parseInt(e.target.value)),children:e&&e.map(e=>{var n,t;return(0,l.jsxs)("option",{value:e.id,children:["(",e.id,") ",null===(n=e.host)||void 0===n?void 0:n.host,":",null===(t=e.host)||void 0===t?void 0:t.port]},e.id)})}),(0,l.jsx)(i.zx,{onClick:e=>k(),width:"full",children:"Dump"})]})]}),(0,l.jsxs)(o.NI,{children:[(0,l.jsx)(o.lX,{textColor:"blue.500",children:"Analyze Heap Profile"}),(0,l.jsxs)(r.gC,{children:[(0,l.jsx)(o.lX,{children:"Dumped By"}),(0,l.jsx)(a.Ph,{onChange:e=>b(e.target.value),children:["Auto","Manually"].map(e=>(0,l.jsx)("option",{value:e,children:e},e))}),(0,l.jsx)(o.lX,{children:"Dumped Files"}),(0,l.jsx)(a.Ph,{onChange:e=>Z(e.target.value),children:_&&_.name.map(e=>(0,l.jsx)("option",{value:e,children:e},e))}),(0,l.jsx)(i.zx,{onClick:e=>z(),width:"full",children:"Analyze"})]})]})]}),(0,l.jsx)(r.xu,{flex:1,height:"full",ml:3,overflowX:"scroll",overflowY:"scroll",children:void 0===s?(0,l.jsx)(x.Z,{}):(0,l.jsx)(c.ZP,{language:"sql",options:{fontSize:13,readOnly:!0,renderWhitespace:"boundary",wordWrap:"on"},defaultValue:'Select a compute node and target profiling result file and click "Analyze"...',value:s})})]})]});return(0,l.jsxs)(m.Fragment,{children:[(0,l.jsx)(h(),{children:(0,l.jsx)("title",{children:"Heap Profiling"})}),D]})}}},function(e){e.O(0,[714,876,295,721,905,888,774,179],function(){return e(e.s=84808)}),_N_E=e.O()}]);