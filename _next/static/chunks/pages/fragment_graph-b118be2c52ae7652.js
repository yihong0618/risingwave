(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[763],{94469:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/fragment_graph",function(){return r(22473)}])},63097:function(e,t,r){"use strict";r.d(t,{b:function(){return o},k:function(){return l}});var n=r(52189),a=r(98032);function l(e){let t=[n.rS.colors.green["100"],n.rS.colors.green["300"],n.rS.colors.yellow["400"],n.rS.colors.orange["500"],n.rS.colors.red["700"]].map(e=>(0,a.H)(e)),r=(e=Math.min(e=Math.max(e,0),100))/100*(t.length-1),l=Math.floor(r);return(0,a.H)(t[l]).mix((0,a.H)(t[Math.ceil(r)]),(r-l)*100).toHexString()}function o(e,t){return(e=Math.min(e=Math.max(e,0),100))/100*t+2}},13157:function(e,t,r){"use strict";r.d(t,{C8:function(){return i},Qc:function(){return l},Uz:function(){return s},_1:function(){return c}});var n=r(68905),a=r(35862);async function l(){return await a.ZP.get("/metrics/fragment/prometheus_back_pressures")}function o(e){let t=new Map,r=new Map,n=new Map;for(let n of e){let e="".concat(n.fragmentId,"-").concat(n.downstreamFragmentId);t.set(e,(t.get(e)||0)+n.value),r.set(e,(r.get(e)||0)+n.actorCount)}for(let[e,a]of t)n.set(e,a/r.get(e));return n}function s(e,t,r){let n=o(e),a=o(t),l=o(r),s=new Map;new Set([...n.keys(),...a.keys(),...l.keys()]).forEach(e=>{let t=n.get(e)||0,r=a.get(e)||0,o=l.get(e)||0;s.set(e,t+(o-r))});let i=[];return s.forEach((e,t)=>{let[r,n]=t.split("-").map(Number);i.push({actorCount:1,fragmentId:r,downstreamFragmentId:n,value:e})}),i}function i(e,t){let r=o(e),n=new Map;return r.forEach((e,r)=>{n.set(r,e/t*100)}),function(e){let t={outputBufferBlockingDuration:[]};for(let r of e)t.outputBufferBlockingDuration.push({metric:{actorId:r.actorId.toString(),fragmentId:r.fragmentId.toString(),downstreamFragmentId:r.downstreamFragmentId.toString()},sample:[{timestamp:Date.now(),value:r.backPressureRate}]});return t}(function(e){let t=[];return e.forEach((e,r)=>{let[n,a]=r.split("-").map(Number);t.push({actorId:0,fragmentId:n,downstreamFragmentId:a,backPressureRate:e})}),t}(n))}async function c(){var e,t;return null!==(t=null===(e=(await a.ZP.get("/metrics/fragment/embedded_back_pressures")).backPressureInfos)||void 0===e?void 0:e.map(n.hL.fromJSON))&&void 0!==t?t:[]}},53911:function(e,t,r){"use strict";r.d(t,{A8:function(){return l},AJ:function(){return s},Sx:function(){return o},jI:function(){return i}});var n=r(6162),a=r.n(n);function l(e,t,r){let n=function(e){let t=new Map;for(let r of e)t.set(r.id,r);let r=new Map,n=new Map,a=e=>{let l=n.get(e);if(void 0!==l)return l;let o={nextNodes:[]},s=t.get(e);if(void 0===s)throw Error("no such id ".concat(e));for(let e of s.parentIds)a(e).nextNodes.push(o);return n.set(e,o),r.set(o,e),o};for(let t of e)a(t.id);let l=new Map,o=[];for(let e of r.keys())o.push(e);for(let e of function(e){let t=[],r=[],n=new Map,a=e=>{if(e.temp)throw Error("This is not a DAG");if(!e.perm){e.temp=!0;let r=-1;for(let t of e.node.nextNodes){n.get(t).isInput=!1,e.isOutput=!1;let l=a(n.get(t));l>r&&(r=l)}e.temp=!1,e.perm=!0,e.g=r+1,t.unshift(e.node)}return e.g};for(let t of e){let e={node:t,temp:!1,perm:!1,isInput:!0,isOutput:!0,g:0};n.set(t,e),r.push(e)}let l=0;for(let e of r){let t=a(e);t>l&&(l=t)}for(let e of r)e.g=l-e.g;let o=[];for(let e=0;e<l+1;++e)o.push({nodes:[],occupyRow:new Set});let s=new Map,i=new Map;for(let e of r)o[e.g].nodes.push(e.node),s.set(e.node,e.g);let c=(e,t)=>{i.set(e,t),o[s.get(e)].occupyRow.add(t)},d=(e,t,r)=>{for(let n=e;n<=t;++n)o[n].occupyRow.add(r)},u=(e,t)=>o[e].occupyRow.has(t),f=(e,t,r)=>{if(r<0)return!1;for(let n=e;n<=t;++n)if(u(n,r))return!0;return!1};for(let t of e)t.nextNodes.sort((e,t)=>s.get(t)-s.get(e));for(let e of o)for(let t of e.nodes){if(!i.has(t)){for(let e of t.nextNodes){if(i.has(e))continue;let r=-1;for(;f(s.get(t),s.get(e),++r););c(t,r),c(e,r),d(s.get(t)+1,s.get(e)-1,r);break}if(!i.has(t)){let e=-1;for(;u(s.get(t),++e););c(t,e)}}for(let e of t.nextNodes){if(i.has(e))continue;let r=i.get(t);if(!f(s.get(t)+1,s.get(e),r)){c(e,r),d(s.get(t)+1,s.get(e)-1,r);continue}for(r=-1;f(s.get(t)+1,s.get(e),++r););c(e,r),d(s.get(t)+1,s.get(e)-1,r)}}let h=new Map;for(let t of e)h.set(t,[s.get(t),i.get(t)]);return h}(o)){let n=r.get(e[0]);if(!n)throw Error("no corresponding item of node ".concat(e[0]));let a=t.get(n);if(!a)throw Error("item id ".concat(n," is not present in idToBox"));l.set(a,e[1])}return l}(e),l=new Map,o=new Map,s=0,i=0;for(let e of n){let t=e[0],r=e[1][0],n=e[1][1],c=l.get(r)||0;t.width>c&&l.set(r,t.width);let d=o.get(n)||0;t.height>d&&o.set(n,t.height),s=a()([r,s])||0,i=a()([n,i])||0}let c=new Map,d=new Map,u=(e,t,r,n)=>{let a=r.get(e);if(a)return a;if(0===e)a=0;else{let l=n.get(e-1);if(!l)throw Error("".concat(e-1," has no result"));a=u(e-1,t,r,n)+l+t}return r.set(e,a),a};for(let e=0;e<=s;++e)u(e,t,c,l);for(let e=0;e<=i;++e)u(e,r,d,o);let f=[];for(let[e,[t,r]]of n){let n=c.get(t),a=d.get(r);if(void 0!==n&&void 0!==a)f.push({x:n,y:a,...e});else throw Error("x of layer ".concat(t,": ").concat(n,", y of row ").concat(r,": ").concat(a," "))}return f}function o(e,t,r,n){return l(e,r,t).map(e=>{let{x:t,y:r,...a}=e;return{x:t+n,y:r+n,...a}}).map(e=>{let{x:t,y:r,...n}=e;return{x:r,y:t,...n}})}function s(e){let t=[],r=new Map;for(let t of e)r.set(t.id,t);for(let n of e)for(let e of n.parentIds){let a=r.get(e);t.push({points:[{x:n.x,y:n.y},{x:a.x,y:a.y}],source:n.id,target:e})}return t}function i(e){let t=[],r=new Map;for(let t of e)r.set(t.id,t);for(let n of e){for(let e of n.parentIds){let a=r.get(e);t.push({points:[{x:n.x+n.width/2,y:n.y+n.height/2},{x:a.x+a.width/2,y:a.y+a.height/2}],source:n.id,target:e})}for(let e of n.externalParentIds)t.push({points:[{x:n.x,y:n.y+n.height/2},{x:n.x+100,y:n.y+n.height/2}],source:n.id,target:e})}return t}},22473:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return T}});var n=r(85893),a=r(40639),l=r(83234),o=r(20979),s=r(57026),i=r(36696),c=r(47741),d=r(79855),u=r(97098),f=r(96486),h=r.n(f),p=r(9008),g=r.n(p),m=r(95100),x=r(67294),y=r(52189),v=r(50361),w=r.n(v);function j(e){let{fragmentDependency:t,svgWidth:r,selectedId:a,onSelectedIdChange:l}=e,o=(0,x.useRef)(null),[s,i]=(0,x.useState)("0px"),c=(0,x.useCallback)(()=>{let e=(0,u.zx)().nodeSize([10,34,5]),r=w()(t),{width:n,height:a}=e(r);return{width:n,height:a,dag:r}},[t])();return(0,x.useEffect)(()=>{let{width:e,height:t,dag:n}=c,s=o.current,u=d.Ys(s),f=d.ak_,h=d.jvg().curve(f).x(e=>{let{x:t}=e;return t+10}).y(e=>{let{y:t}=e;return t}),p=e=>e.data.id===a,g=u.select(".edges").selectAll(".edge").data(n.links()),m=e=>e.attr("d",e=>{let{points:t}=e;return h(t)}).attr("fill","none").attr("stroke-width",e=>p(e.source)||p(e.target)?2:1).attr("stroke",e=>p(e.source)||p(e.target)?y.rS.colors.blue["500"]:y.rS.colors.gray["300"]);g.exit().remove(),g.enter().call(e=>e.append("path").attr("class","edge").call(m)),g.call(m);let x=u.select(".nodes").selectAll(".node").data(n.descendants()),v=e=>e.attr("transform",e=>"translate(".concat(e.x+10,", ").concat(e.y,")")).attr("fill",e=>p(e)?y.rS.colors.blue["500"]:y.rS.colors.gray["500"]);x.exit().remove(),x.enter().call(e=>e.append("circle").attr("class","node").attr("r",5).call(v)),x.call(v);let w=u.select(".labels").selectAll(".label").data(n.descendants()),j=e=>e.text(e=>e.data.name).attr("x",r-10).attr("font-family","inherit").attr("text-anchor","end").attr("alignment-baseline","middle").attr("y",e=>e.y).attr("fill",e=>p(e)?y.rS.colors.black["500"]:y.rS.colors.gray["500"]).attr("font-weight","600");w.exit().remove(),w.enter().call(e=>e.append("text").attr("class","label").call(j)),w.call(j);let I=u.select(".overlays").selectAll(".overlay").data(n.descendants()),S=e=>e.attr("x",3).attr("height",24).attr("width",r-6).attr("y",e=>e.y-5-12+2+3).attr("rx",5).attr("fill",y.rS.colors.gray["500"]).attr("opacity",0).style("cursor","pointer");I.exit().remove(),I.enter().call(e=>e.append("rect").attr("class","overlay").call(S).on("mouseover",function(e,t){d.Ys(this).transition().duration(parseInt(y.rS.transition.duration.normal)).attr("opacity",".10")}).on("mouseout",function(e,t){d.Ys(this).transition().duration(parseInt(y.rS.transition.duration.normal)).attr("opacity","0")}).on("mousedown",function(e,t){d.Ys(this).transition().duration(parseInt(y.rS.transition.duration.normal)).attr("opacity",".20")}).on("mouseup",function(e,t){d.Ys(this).transition().duration(parseInt(y.rS.transition.duration.normal)).attr("opacity",".10")}).on("click",function(e,t){l&&l(t.data.id)})),I.call(S),i("".concat(t,"px"))},[t,a,r,l,c]),(0,n.jsxs)("svg",{ref:o,width:"".concat(r,"px"),height:s,children:[(0,n.jsx)("g",{className:"edges"}),(0,n.jsx)("g",{className:"nodes"}),(0,n.jsx)("g",{className:"labels"}),(0,n.jsx)("g",{className:"overlays"})]})}var I=r(39653),S=r(79351),k=r(63679),b=r(53911),N=r(63097);let M=(0,k.ZP)(()=>r.e(171).then(r.t.bind(r,55171,23)));function E(e){let{planNodeDependencies:t,fragmentDependency:r,selectedFragmentId:a,backPressures:l}=e,o=(0,x.useRef)(null),{isOpen:s,onOpen:i,onClose:u}=(0,I.qY)(),[f,h]=(0,x.useState)(),p=(0,x.useCallback)(e=>{h(e),i()},[i,h]),{svgWidth:g,svgHeight:m,edges:v,layoutResult:j,includedFragmentIds:k}=(0,x.useCallback)(()=>{let e=w()(t),n=w()(r),a=new Map,l=new Set;for(let[t,r]of e){var o;let e=function(e,t){let{dx:r,dy:n}=t,a=d.G_s().nodeSize([n,r])(e);return a.each(e=>([e.x,e.y]=[e.y,e.x])),a.each(e=>e.x=-e.x),a}(r,{dx:72,dy:48}),{width:n,height:s}=function(e,t){let{margin:{top:r,bottom:n,left:a,right:l}}=t,o=1/0,s=-1/0,i=1/0,c=-1/0;return e.each(e=>s=e.x>s?e.x:s),e.each(e=>o=e.x<o?e.x:o),e.each(e=>c=e.y>c?e.y:c),e.each(e=>i=e.y<i?e.y:i),o-=a,s+=l,i-=r,c+=n,e.each(e=>e.x=e.x-o),e.each(e=>e.y=e.y-i),{width:s-o,height:c-i}}(e,{margin:{left:72,right:72,top:60,bottom:72}});a.set(t,{layoutRoot:e,width:n,height:s,actorIds:null!==(o=r.data.actorIds)&&void 0!==o?o:[]}),l.add(t)}let s=(0,b.A8)(n.map(e=>{let{width:t,height:r,id:n,...l}=e,{width:o,height:s}=a.get(n);return{width:o,height:s,id:n,...l}}),24,24),i=new Map;s.forEach(e=>{let{id:t,x:r,y:n}=e;i.set(t,{x:r,y:n})});let c=[];for(let[e,t]of a){let{x:r,y:n}=i.get(e);c.push({id:e,x:r,y:n,...t})}let u=0,f=0;c.forEach(e=>{let{x:t,y:r,width:n,height:a}=e;f=Math.max(f,r+a+50),u=Math.max(u,t+n)});let h=(0,b.jI)(s);return{layoutResult:c,svgWidth:u,svgHeight:f,edges:h,includedFragmentIds:l}},[t,r])();return(0,x.useEffect)(()=>{if(j){let e=o.current,t=d.Ys(e),r=d.h5h().x(e=>e.x).y(e=>e.y),n=e=>e===a,s=e=>{e.attr("transform",e=>{let{x:t,y:r}=e;return"translate(".concat(t,", ").concat(r,")")});let t=e.select(".text-frag-id");t.empty()&&(t=e.append("text").attr("class","text-frag-id")),t.attr("fill","black").text(e=>{let{id:t}=e;return"Fragment ".concat(t)}).attr("font-family","inherit").attr("text-anchor","end").attr("dy",e=>{let{height:t}=e;return t-24+12}).attr("dx",e=>{let{width:t}=e;return t-24}).attr("fill","black").attr("font-size",12);let a=e.select(".text-actor-id");a.empty()&&(a=e.append("text").attr("class","text-actor-id")),a.attr("fill","black").text(e=>{let{actorIds:t}=e;return"Actor ".concat(t.join(", "))}).attr("font-family","inherit").attr("text-anchor","end").attr("dy",e=>{let{height:t}=e;return t-24+24}).attr("dx",e=>{let{width:t}=e;return t-24}).attr("fill","black").attr("font-size",12);let l=e.select(".bounding-box");l.empty()&&(l=e.append("rect").attr("class","bounding-box")),l.attr("width",e=>{let{width:t}=e;return t-48}).attr("height",e=>{let{height:t}=e;return t-48}).attr("x",24).attr("y",24).attr("fill","white").attr("stroke-width",e=>{let{id:t}=e;return n(t)?3:1}).attr("rx",5).attr("stroke",e=>{let{id:t}=e;return n(t)?y.rS.colors.blue[500]:y.rS.colors.gray[500]});let o=e.select(".edges");o.empty()&&(o=e.append("g").attr("class","edges"));let s=e=>e.attr("d",r),i=o.selectAll("path").data(e=>{let{layoutRoot:t}=e;return t.links()});i.enter().call(e=>(e.append("path").attr("fill","none").attr("stroke",y.rS.colors.gray[700]).attr("stroke-width",1.5).call(s),e)),i.call(s),i.exit().remove();let c=e.select(".nodes");c.empty()&&(c=e.append("g").attr("class","nodes"));let d=e=>{e.attr("transform",e=>"translate(".concat(e.x,",").concat(e.y,")"));let t=e.select("circle");t.empty()&&(t=e.append("circle")),t.attr("fill",y.rS.colors.blue[500]).attr("r",12).style("cursor","pointer").on("click",(e,t)=>p(t.data));let r=e.select("text");r.empty()&&(r=e.append("text")),r.attr("fill","black").text(e=>e.data.name).attr("font-family","inherit").attr("text-anchor","middle").attr("dy",21.6).attr("fill","black").attr("font-size",12).attr("transform","rotate(-8)");let n=e.select("title");return n.empty()&&(n=e.append("title")),n.text(e=>{var t;return null!==(t=e.data.node.identity)&&void 0!==t?t:e.data.name}),e},u=c.selectAll(".stream-node").data(e=>{let{layoutRoot:t}=e;return t.descendants()});u.exit().remove(),u.enter().call(e=>e.append("g").attr("class","stream-node").call(d)),u.call(d)},i=t.select(".fragments").selectAll(".fragment").data(j);i.enter().call(e=>e.append("g").attr("class","fragment").call(s)),i.call(s),i.exit().remove();let c=t.select(".fragment-edges").selectAll(".fragment-edge").data(v),u=d.FdL,f=d.jvg().curve(u).x(e=>{let{x:t}=e;return t}).y(e=>{let{y:t}=e;return t}),h=e=>{let t=e.select("path");t.empty()&&(t=e.append("path"));let r=e=>n(e.source)||n(e.target);t.attr("d",e=>{let{points:t}=e;return f(t)}).attr("fill","none").attr("stroke-width",e=>{if(l){let t=l.get("".concat(e.target,"_").concat(e.source));if(t)return(0,N.b)(t,30)}return r(e)?4:2}).attr("stroke",e=>{if(l){let t=l.get("".concat(e.target,"_").concat(e.source));if(t)return(0,N.k)(t)}return r(e)?y.rS.colors.blue["500"]:y.rS.colors.gray["300"]});let a=e.select("title");return a.empty()&&(a=e.append("title")),a.text(e=>{if(l){let t=l.get("".concat(e.target,"_").concat(e.source));if(t)return"".concat(t.toFixed(2),"%")}return""}),e};c.enter().call(e=>e.append("g").attr("class","fragment-edge").call(h)),c.call(h),c.exit().remove()}},[j,v,l,a,p]),(0,n.jsxs)(x.Fragment,{children:[(0,n.jsxs)(S.u_,{isOpen:s,onClose:u,size:"5xl",children:[(0,n.jsx)(S.ZA,{}),(0,n.jsxs)(S.hz,{children:[(0,n.jsxs)(S.xB,{children:[null==f?void 0:f.operatorId," - ",null==f?void 0:f.name]}),(0,n.jsx)(S.ol,{}),(0,n.jsx)(S.fe,{children:s&&(null==f?void 0:f.node)&&(0,n.jsx)(M,{shouldCollapse:e=>{let{name:t}=e;return"input"===t||"fields"===t||"streamKey"===t},src:f.node,collapsed:3,name:null,displayDataTypes:!1})}),(0,n.jsx)(S.mz,{children:(0,n.jsx)(c.zx,{colorScheme:"blue",mr:3,onClick:u,children:"Close"})})]})]}),(0,n.jsxs)("svg",{ref:o,width:"".concat(g,"px"),height:"".concat(m,"px"),children:[(0,n.jsx)("g",{className:"fragment-edges"}),(0,n.jsx)("g",{className:"fragments"})]})]})}var _=r(64030),C=r(61642),D=r(44599),P=r(13157),A=r(33256);function T(){var e,t,r;let{response:f}=(0,D.Z)(A.gG),{response:p}=(0,D.Z)(A.KY),[y,v]=(0,m.v1)("id",m.U),[w,I]=(0,x.useState)(),[S,k]=(0,x.useState)(),b=(0,x.useMemo)(()=>null==f?void 0:f.find(e=>e.id===y),[f,y]),N=(0,C.Z)();(0,x.useEffect)(()=>{y&&(k(void 0),(0,A.Dx)(y).then(e=>{k(e)}))},[y]);let M=(0,x.useCallback)(()=>{if(S){let e=function(e){let t=[],r=new Map;for(let t in e.fragments)for(let n of e.fragments[t].actors)r.set(n.actorId,n.fragmentId);for(let n in e.fragments){let a=e.fragments[n],l=new Set,o=new Set;for(let e of a.actors)for(let t of e.upstreamActorId){let n=r.get(t);if(n)l.add(n);else for(let t of function(e){let t=new Set,r=e=>{var n;for(let a of((null===(n=e.nodeBody)||void 0===n?void 0:n.$case)==="merge"&&t.add(e.nodeBody.merge),e.input||[]))r(a)};return r(e),Array.from(t)}(e.nodes))o.add(t.upstreamFragmentId)}t.push({id:a.fragmentId.toString(),name:"Fragment ".concat(a.fragmentId),parentIds:Array.from(l).map(e=>e.toString()),externalParentIds:Array.from(o).map(e=>e.toString()),width:0,height:0,order:a.fragmentId,fragment:a})}return t}(S);return{fragments:S,fragmentDep:e,fragmentDepDag:(0,u.lu)()(e)}}},[S]);(0,x.useEffect)(()=>{f&&!y&&f.length>0&&v(f[0].id)},[y,f,v]);let T=null===(e=M())||void 0===e?void 0:e.fragmentDep,B=null===(t=M())||void 0===t?void 0:t.fragmentDepDag,F=null===(r=M())||void 0===r?void 0:r.fragments,z=(0,x.useCallback)(()=>{let e=null==F?void 0:F.fragments;if(e){let t=new Map;for(let r in e){let n=function(e){let t;let r=e.actors[0],n=e=>{var t,r;return{name:(null===(r=e.nodeBody)||void 0===r?void 0:null===(t=r.$case)||void 0===t?void 0:t.toString())||"unknown",children:(e.input||[]).map(n),operatorId:e.operatorId,node:e}};if(r.dispatcher.length>0){let e=h().camelCase(r.dispatcher[0].type.replace(/^DISPATCHER_TYPE_/,""));t=r.dispatcher.length>1?r.dispatcher.every(e=>e.type===r.dispatcher[0].type)?"".concat(e,"Dispatchers"):"multipleDispatchers":"".concat(e,"Dispatcher")}else t="noDispatcher";let a=e.actors.reduce((e,t)=>(e[t.actorId]=t.dispatcher,e),{});return a.fragment={...e,actors:[]},d.bT9({name:t,actorIds:e.actors.map(e=>e.actorId.toString()),children:r.nodes?[n(r.nodes)]:[],operatorId:"dispatcher",node:a})}(e[r]);t.set(r,n)}return t}},[null==F?void 0:F.fragments])(),[Y,R]=(0,x.useState)(""),[Z,G]=(0,x.useState)(""),W=()=>{let e=parseInt(Z);if(p){let t=p.map;for(let r in t){let n=t[r].map;for(let t in n)if(parseInt(t)==e){v(parseInt(r)),I(e);return}}}N(Error("Fragment ".concat(e," not found")))},X=()=>{let e=parseInt(Y);if(p){let t=p.map;for(let r in t){let n=t[r].map;for(let t in n)if(n[t].ids.includes(e)){v(parseInt(r)),I(parseInt(t));return}}}N(Error("Actor ".concat(e," not found")))},[O,H]=(0,x.useState)("Embedded"),{response:U}=(0,D.Z)(P.Qc,5e3,"Prometheus"===O),[J,L]=(0,x.useState)();(0,x.useEffect)(()=>{if("Embedded"===O){let e=setInterval(()=>{(0,P._1)().then(e=>{console.log(e),L(t=>t?{previous:t.current,current:e,totalBackpressureNs:(0,P.Uz)(t.totalBackpressureNs,t.current,e),totalDurationNs:t.totalDurationNs+5e9}:{previous:e,current:e,totalBackpressureNs:[],totalDurationNs:0})},e=>{console.error(e),N(e,"error")})},5e3);return()=>{clearInterval(e)}}},[O,N]);let K=(0,x.useMemo)(()=>{if(U||J){let e=new Map;if("Embedded"===O&&J)for(let t of(0,P.C8)(J.totalBackpressureNs,J.totalDurationNs).outputBufferBlockingDuration)e.set("".concat(t.metric.fragmentId,"_").concat(t.metric.downstreamFragmentId),t.sample[0].value);else if("Prometheus"===O&&U){for(let t of U.outputBufferBlockingDuration)if(t.sample.length>0){let r=100*h()(t.sample).maxBy(e=>e.timestamp).value;e.set("".concat(t.metric.fragment_id,"_").concat(t.metric.downstream_fragment_id),r)}}return e}},[O,U,J]),Q=(0,n.jsxs)(a.kC,{p:3,height:"calc(100vh - 20px)",flexDirection:"column",children:[(0,n.jsx)(_.Z,{children:"Fragment Graph"}),(0,n.jsxs)(a.kC,{flexDirection:"row",height:"full",width:"full",children:[(0,n.jsxs)(a.gC,{mr:3,spacing:3,alignItems:"flex-start",width:225,height:"full",children:[(0,n.jsxs)(l.NI,{children:[(0,n.jsx)(l.lX,{children:"Streaming Jobs"}),(0,n.jsx)(o.II,{list:"relationList",spellCheck:!1,onChange:e=>{var t;let r=null==f?void 0:null===(t=f.find(t=>t.name==e.target.value))||void 0===t?void 0:t.id;r&&v(r)},placeholder:"Search...",mb:2}),(0,n.jsx)("datalist",{id:"relationList",children:f&&f.map(e=>(0,n.jsxs)("option",{value:e.name,children:["(",e.id,") ",e.name]},e.id))}),(0,n.jsx)(s.Ph,{value:null!=y?y:void 0,onChange:e=>v(parseInt(e.target.value)),children:f&&f.map(e=>(0,n.jsxs)("option",{value:e.id,children:["(",e.id,") ",e.name]},e.name))})]}),b&&(0,n.jsxs)(l.NI,{children:[(0,n.jsx)(l.lX,{children:"Information"}),(0,n.jsx)(i.xJ,{children:(0,n.jsx)(i.iA,{size:"sm",children:(0,n.jsxs)(i.p3,{children:[(0,n.jsxs)(i.Tr,{children:[(0,n.jsx)(i.Td,{fontWeight:"medium",children:"Type"}),(0,n.jsx)(i.Td,{isNumeric:!0,children:b.type})]}),(0,n.jsxs)(i.Tr,{children:[(0,n.jsx)(i.Td,{fontWeight:"medium",children:"Status"}),(0,n.jsx)(i.Td,{isNumeric:!0,children:b.jobStatus})]}),(0,n.jsxs)(i.Tr,{children:[(0,n.jsx)(i.Td,{fontWeight:"medium",children:"Parallelism"}),(0,n.jsx)(i.Td,{isNumeric:!0,children:b.parallelism})]}),(0,n.jsxs)(i.Tr,{children:[(0,n.jsx)(i.Td,{fontWeight:"medium",paddingEnd:0,children:"Max Parallelism"}),(0,n.jsx)(i.Td,{isNumeric:!0,children:b.maxParallelism})]})]})})})]}),(0,n.jsxs)(l.NI,{children:[(0,n.jsx)(l.lX,{children:"Goto"}),(0,n.jsxs)(a.gC,{spacing:2,children:[(0,n.jsxs)(a.Ug,{children:[(0,n.jsx)(o.II,{placeholder:"Fragment Id",value:Z,onChange:e=>G(e.target.value)}),(0,n.jsx)(c.zx,{onClick:e=>W(),children:"Go"})]}),(0,n.jsxs)(a.Ug,{children:[(0,n.jsx)(o.II,{placeholder:"Actor Id",value:Y,onChange:e=>R(e.target.value)}),(0,n.jsx)(c.zx,{onClick:e=>X(),children:"Go"})]})]})]}),(0,n.jsxs)(l.NI,{children:[(0,n.jsx)(l.lX,{children:"Back Pressure Data Source"}),(0,n.jsxs)(s.Ph,{value:O,onChange:e=>H(e.target.value),defaultValue:"Embedded",children:[(0,n.jsx)("option",{value:"Embedded",children:"Embedded (5 secs)"},"Embedded"),(0,n.jsx)("option",{value:"Prometheus",children:"Prometheus (1 min)"},"Prometheus")]})]}),(0,n.jsxs)(a.kC,{height:"full",width:"full",flexDirection:"column",children:[(0,n.jsx)(a.xv,{fontWeight:"semibold",children:"Fragments"}),B&&(0,n.jsx)(a.xu,{flex:"1",overflowY:"scroll",children:(0,n.jsx)(j,{svgWidth:225,fragmentDependency:B,onSelectedIdChange:e=>I(parseInt(e)),selectedId:null==w?void 0:w.toString()})})]})]}),(0,n.jsxs)(a.xu,{flex:1,height:"full",ml:3,overflowX:"scroll",overflowY:"scroll",children:[(0,n.jsx)(a.xv,{fontWeight:"semibold",children:"Fragment Graph"}),z&&T&&(0,n.jsx)(E,{selectedFragmentId:null==w?void 0:w.toString(),fragmentDependency:T,planNodeDependencies:z,backPressures:K})]})]})]});return(0,n.jsxs)(x.Fragment,{children:[(0,n.jsx)(g(),{children:(0,n.jsx)("title",{children:"Streaming Fragments"})}),Q]})}}},function(e){e.O(0,[662,876,679,184,278,591,653,561,990,512,721,371,905,888,774,179],function(){return e(e.s=94469)}),_N_E=e.O()}]);